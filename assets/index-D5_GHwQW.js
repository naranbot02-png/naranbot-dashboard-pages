(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const c of e.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function l(o){if(o.ep)return;o.ep=!0;const e=i(o);fetch(o.href,e)}})();const n={gateway:document.getElementById("gateway"),version:document.getElementById("version"),model:document.getElementById("model"),updated:document.getElementById("updated"),pct:document.getElementById("pct"),pctBar:document.getElementById("pctBar"),total:document.getElementById("total"),remain:document.getElementById("remain"),lastio:document.getElementById("lastio"),msgs:document.getElementById("msgs"),light:document.getElementById("light"),smart:document.getElementById("smart"),alerts:document.getElementById("alerts"),hist:document.getElementById("hist"),events:document.getElementById("events"),raw:document.getElementById("raw"),repos:document.getElementById("repos")};function d(t){try{return new Date(t).toLocaleString()}catch{return t}}function r(t,s){t.textContent=s==null||s===""?"—":String(s)}function m(t){r(n.gateway,t.gateway?.status||"unknown"),r(n.version,t.gateway?.version||"—"),r(n.model,t.model?.current||"—"),r(n.updated,d(t.updatedAt));const s=t.usage?.percentUsed;r(n.pct,s??"—"),typeof s=="number"?n.pctBar.style.width=Math.max(0,Math.min(100,s))+"%":n.pctBar.style.width="0%",r(n.total,t.usage?.totalTokens??"—"),r(n.remain,t.usage?.remainingTokens??"—");const i=t.usage?.lastInputTokens,l=t.usage?.lastOutputTokens;r(n.lastio,i===void 0||l===void 0?"—":`${i}/${l}`),r(n.msgs,t.counters?.messagesToday??"—"),r(n.light,t.counters?.tickLightToday??"—"),r(n.smart,t.counters?.tickSmartToday??"—"),r(n.alerts,(t.alerts||[]).length?t.alerts.map(e=>e.title).join(" · "):"ninguna"),n.repos.innerHTML="",(t.repos||[]).forEach(e=>{const c=document.createElement("li");c.innerHTML=`<a href="${e.url}" target="_blank" rel="noreferrer">${e.name}</a>`+(e.pages?` — <a href="${e.pages}" target="_blank" rel="noreferrer">Pages</a>`:""),n.repos.appendChild(c)});const o=(t.events||[]).slice(0,30).map(e=>`[${e.ts}] ${e.kind}: ${e.msg}`).join(`
`);n.events.textContent=o||"—",n.raw.textContent=JSON.stringify(t,null,2)}async function a(){const s=await(await fetch("./status.json?ts="+Date.now(),{cache:"no-store"})).json();m(s);try{const i=await fetch("./history.json?ts="+Date.now(),{cache:"no-store"});if(i.ok){const o=(await i.json()).slice(-12).map(e=>{const c=new Date(e.ts).toLocaleTimeString(),u=e.percentUsed??"—";return`${c} · used=${u}% · model=${e.model||"—"} · last in/out=${e.lastInputTokens??"—"}/${e.lastOutputTokens??"—"}`}).join(`
`);n.hist.textContent=o||"—"}else n.hist.textContent="—"}catch{n.hist.textContent="—"}}document.getElementById("btn").addEventListener("click",a);a().catch(t=>{n.events.textContent="Error cargando status.json: "+t});
